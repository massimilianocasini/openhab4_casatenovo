rule "Antifurto cambio stato swicth case"
when 
    Item Prodino0_optoIn0 changed
then
val telegramActions = getActions("telegram","telegram:telegramBot:Telegram_Bot")

switch(Prodino0_optoIn0.state) {
  case  "INSERITO" : {
    telegramActions.sendTelegram("Antifurto INSerito!")
    logInfo("Alarm.rules", "Antifurto INSERITO")
    if (DaikinACUnit_Mode_Studio.state == "HEAT" && DaikinACUnit_Power_Studio.state == ON) {
        DaikinACUnit_Power_Studio.sendCommand(OFF)
        telegramActions.sendTelegram("Condizionatore Studio spento")
    }
    if (DaikinACUnit_Mode_Soggiorno.state == "HEAT" && DaikinACUnit_Power_Soggiorno.state == ON) {
        DaikinACUnit_Power_Soggiorno.sendCommand(OFF)
        telegramActions.sendTelegram("Condizionatore Soggiorno spento")
    }
    if (DaikinACUnit_Mode_Cameretta.state == "HEAT" && DaikinACUnit_Power_Cameretta.state == ON) {
        DaikinACUnit_Power_Cameretta.sendCommand(OFF)
        telegramActions.sendTelegram("Condizionatore Cameretta spento")
    }
    if (DaikinACUnit_Mode_Letto.state == "HEAT" && DaikinACUnit_Power_Letto.state == ON) {
        DaikinACUnit_Power_Letto.sendCommand(OFF)
        telegramActions.sendTelegram("Condizionatore Letto spento")
    }
    if (TapparellaLetto.state < 100) {
        TapparellaLetto.sendCommand(DOWN)
        logInfo("Alarm.rules", "Tapparella letto DOWN")
    }
    if (TapparellaStudio.state < 100) {
        TapparellaStudio.sendCommand(DOWN)
        logInfo("Alarm.rules", "Tapparella studio DOWN")
    }
    if (TapparellaSoggiorno.state < 100) {
        TapparellaSoggiorno.sendCommand(DOWN)
        logInfo("Alarm.rules", "Tapparella soggiorno DOWN")
    }
    if (TapparellaCameretta.state < 100) {
        TapparellaCameretta.sendCommand(DOWN)
        logInfo("Alarm.rules", "Tapparella cameretta DOWN")
    }
  }
  case "DISINSERITO": {
    telegramActions.sendTelegram("Antifurto DIsInserito!")
    logInfo("Alarm.rules", "Antifurto DISINSERITO")
    if (SunElevation.state > -3 && now.getHour > 8) {
        TapparellaLetto.sendCommand(UP)
        TapparellaStudio.sendCommand(UP)
        TapparellaSoggiorno.sendCommand(UP)
        TapparellaCameretta.sendCommand(UP)
    }
  }
}
end

rule "Allarme antifurto"
when
    Item Prodino0_optoIn1 changed
then
  val pushoverActions = getActions("pushover", "pushover:pushover-account:account")
  val telegramActions = getActions("telegram","telegram:telegramBot:Telegram_Bot")
  if(Prodino0_optoIn1.state == "ALLARME") {
    var receipt = pushoverActions.sendPriorityMessage("Allarme antifurto", "openhab3", 2)
    telegramActions.sendTelegram("Allarme antifurto")
    // wait for your cancel condition
      if( receipt !== null ) {
        pushoverActions.cancelPriorityMessage(receipt)
        receipt = null
      }
  }
  else if (Prodino0_optoIn1.state == "RIPOSO") {
    pushoverActions.sendMessage("FINE Allarme antifurto", "openhab3")
    telegramActions.sendTelegram("FINE Allarme antifurto")
    // wait for your cancel condition
    if( receipt !== null ) {
      pushoverActions.cancelPriorityMessage(receipt)
      receipt = null
    }
  }
end
rule "Mancanza rete"
when
    Item Prodino0_optoIn2 changed
then
  val pushoverActions = getActions("pushover", "pushover:pushover-account:account")
  val telegramActions = getActions("telegram","telegram:telegramBot:Telegram_Bot")
  if(Prodino0_optoIn2.state == "220VOK") {
    var receipt = pushoverActions.sendPriorityMessage("Ripristino 220V", "openhab3", 2)
    telegramActions.sendTelegram("Ripristino 220V")
    // wait for your cancel condition
    if( receipt !== null ) {
      pushoverActions.cancelPriorityMessage(receipt)
      receipt = null
        }
  }
  else if (Prodino0_optoIn2.state == "NO220V") {
    var receipt = pushoverActions.sendPriorityMessage("Mancanza 220V", "openhab3", 2)
    telegramActions.sendTelegram("Mancanza 220V")
    // wait for your cancel condition
    if( receipt !== null ) {
      pushoverActions.cancelPriorityMessage(receipt)
      receipt = null
        }
  }
end